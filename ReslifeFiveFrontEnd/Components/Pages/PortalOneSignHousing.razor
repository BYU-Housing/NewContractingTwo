@page "/portalOneSignHousing"
@inject NavigationManager NavigationManager
@using Microsoft.AspNetCore.WebUtilities

<h3>PortalOneSignHousing</h3>

<p>Adobe Sign</p>

@if (parameters != null && parameters.Any())
{
    <h4>URL Parameters:</h4>
    <ul>
        @foreach (var param in parameters)
        {
            <li>@param.Key: @param.Value</li>
        }
    </ul>
}
else
{
    <p>No parameters were passed to this page.</p>
}

<iframe src="@iframeSrc"
        width="100%"
        height="100%"
        frameborder="0"
        style="border: 0; overflow: hidden; min-height: 500px; min-width: 600px;">
</iframe>

@code {
    private Dictionary<string, string> parameters = new();
    private string iframeSrc;

    protected override void OnInitialized()
    {
        var uri = new Uri(NavigationManager.Uri);
        parameters = QueryHelpers.ParseQuery(uri.Query)
                                  .ToDictionary(kvp => kvp.Key, kvp => kvp.Value.ToString());

        // Extract Area parameter value
        var areaValue = parameters.ContainsKey("Area") ? parameters["Area"] : "0";

        // Map Area to the appropriate name
        string areaName = areaValue switch
        {
            "1" => "Helaman",
            "2" => "Heritage",
            "3" => "Riviera",
            "4" => "Wyview",
            _ => "Unknown"
        };

        // Replace Area in the Adobe Sign iframe URL
        // iframeSrc = $"https://byusign.na2.adobesign.com/public/esignWidget?wid=CBFCIBAA3AAABLblqZhDM3zCrudXhWDBOpRpgO3eb81DCYxg860qVofVXyHDFouQU9N84_ViVlbBrUb_eldc*&hosted=false#Prop1={areaName}";
        iframeSrc = $"https://byusign.na2.adobesign.com/public/esignWidget?wid=CBFCIBAA3AAABLblqZhD6GSr5RGKWWtGQaTDQoWWkP5L8eDLRIgJDL1LNWhGga68DHsVk0Da0FC-8r9wGeFQ*&hosted=false#Name=Brandon&Net=bjack216&Bdg=9&Apt=3009&Bed=1A ";
        //iframeSrc = $"https://byusign.na2.adobesign.com/public/esignWidget?wid=CBFCIBAA3AAABLblqZhDw3T_sOtZIPwLVO7GH22jMsrIQPwuzuq1ehIWwpqgyINlORquOAi4E8LfbWMBqmOI*&hosted=false#V1=Test&V2=Test2&V3=Test3&V4=Test4&V5=Test5&V6=Test6&V7=Test7&V8=Test8&V9=Test9&V10=Test10&V11=Test11&V12=Test12&V13=Test13&V14=Test14&V15=Test15&V16=Test16&V17=Test17&V18=Test18&V19=Test19&V20=Test20&V21=Test21&V22=Test22&V23=Test23&V24=Test24&V25=Test25&V26=Test26&V27=Test27&V28=Test28&V29=Test29&V30=Test30&V31=Test31&V32=Test32&V33=Test33&V34=Test34&V35=Test35&V36=Test36&V37=Test37&V38=Test38&V39=Test39";
    }
}

