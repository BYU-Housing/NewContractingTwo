@page "/stepSixSelectBedspace"
@inject NavigationManager NavigationManager
@inject IGenService GenService

<h3>Step Six: Select Bedspace</h3>

<p>All URL Parameters:</p>
<p>@AllUrlParameters</p>

<h4>Allocation Test IDs:</h4>
@if (AllocationTests.Any())
{
    <ul>
        @foreach (var allocation in AllocationTests)
        {
            <li>Id: @allocation.Id</li>
        }
    </ul>
}
else
{
    <p>No Allocation Test rows found.</p>
}

@code {
    private string AllUrlParameters = string.Empty;
    private List<AllocationTest> AllocationTests = new();

    protected override void OnInitialized()
    {
        // Ensure NavigationManager is injected and used properly
        var uri = new Uri(NavigationManager.Uri);
        var queryParams = Microsoft.AspNetCore.WebUtilities.QueryHelpers.ParseQuery(uri.Query);

        // Combine URL parameters into a string
        AllUrlParameters = string.Join("&", queryParams.Select(kvp => $"{kvp.Key}={kvp.Value}"));

        // Fetch AllocationTest rows
        AllocationTests = GenService.GetModel<AllocationTest>().ToList();
    }
}
